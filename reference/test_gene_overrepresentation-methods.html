<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>analyse gene over-representation with GSEA — test_gene_overrepresentation • tidybulk</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="analyse gene over-representation with GSEA — test_gene_overrepresentation" />
<meta property="og:description" content="test_gene_overrepresentation() takes as input a `tbl` formatted as | &amp;lt;SAMPLE&amp;gt; | &amp;lt;ENSEMBL_ID&amp;gt; | &amp;lt;COUNT&amp;gt; | &amp;lt;...&amp;gt; | and returns a `tbl` with the GSEA statistics" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tidybulk</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/comparison_with_base_R.html">Comparison with base R</a>
    </li>
    <li>
      <a href="../articles/introduction.html">Overview of the tidybulk package</a>
    </li>
    <li>
      <a href="../articles/manuscript_differential_transcript_abundance.html">Manuscript code - differential transcript abundance</a>
    </li>
    <li>
      <a href="../articles/manuscript_transcriptional_signatures.html">Manuscript code - transcriptional signature identification</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>analyse gene over-representation with GSEA</h1>
    
    <div class="hidden name"><code>test_gene_overrepresentation-methods.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>test_gene_overrepresentation() takes as input a `tbl` formatted as | &lt;SAMPLE&gt; | &lt;ENSEMBL_ID&gt; | &lt;COUNT&gt; | &lt;...&gt; | and returns a `tbl` with the GSEA statistics</p>
    </div>

    <pre class="usage"><span class='fu'>test_gene_overrepresentation</span><span class='op'>(</span>
  <span class='va'>.data</span>,
  .sample <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>.entrez</span>,
  <span class='va'>.do_test</span>,
  <span class='va'>species</span>,
  gene_set <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span>

<span class='co'># S4 method for spec_tbl_df</span>
<span class='fu'>test_gene_overrepresentation</span><span class='op'>(</span>
  <span class='va'>.data</span>,
  .sample <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>.entrez</span>,
  <span class='va'>.do_test</span>,
  <span class='va'>species</span>,
  gene_set <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span>

<span class='co'># S4 method for tbl_df</span>
<span class='fu'>test_gene_overrepresentation</span><span class='op'>(</span>
  <span class='va'>.data</span>,
  .sample <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>.entrez</span>,
  <span class='va'>.do_test</span>,
  <span class='va'>species</span>,
  gene_set <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span>

<span class='co'># S4 method for tidybulk</span>
<span class='fu'>test_gene_overrepresentation</span><span class='op'>(</span>
  <span class='va'>.data</span>,
  .sample <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>.entrez</span>,
  <span class='va'>.do_test</span>,
  <span class='va'>species</span>,
  gene_set <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>.data</th>
      <td><p>A `tbl` formatted as | &lt;SAMPLE&gt; | &lt;TRANSCRIPT&gt; | &lt;COUNT&gt; | &lt;...&gt; |</p></td>
    </tr>
    <tr>
      <th>.sample</th>
      <td><p>The name of the sample column</p></td>
    </tr>
    <tr>
      <th>.entrez</th>
      <td><p>The ENTREZ ID of the transcripts/genes</p></td>
    </tr>
    <tr>
      <th>.do_test</th>
      <td><p>A boolean column name symbol. It indicates the transcript to check</p></td>
    </tr>
    <tr>
      <th>species</th>
      <td><p>A character. For example, human or mouse. MSigDB uses the latin species names (e.g., \"Mus musculus\", \"Homo sapiens\")</p></td>
    </tr>
    <tr>
      <th>gene_set</th>
      <td><p>A character vector. The subset of MSigDB datasets you want to test against (e.g. \"C2\"). If NULL all gene sets are used (suggested). This argument was added to avoid time overflow of the examples.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A `tbl` object</p>
<p>A `tbl` object</p>
<p>A `tbl` object</p>
<p>A `tbl` object</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><a href='https://www.tidyverse.org/lifecycle/#maturing'><img src='figures/lifecycle-maturing.svg' alt='Maturing lifecycle'></a></p>
<p>This wrapper execute gene enrichment analyses of the dataset using a list of transcripts and GSEA.
This wrapper uses clusterProfiler (DOI: doi.org/10.1089/omi.2011.0118) on the back-end.</p>
<p>Undelying method:
 msigdbr::msigdbr(species = species) <!-- %&gt;%#' -->
	nest(data = -gs_cat) <!-- %&gt;% -->
	mutate(test =
			map(
				data,
				~ clusterProfiler::enricher(
					my_entrez_rank,
				 	TERM2GENE=.x <!-- %&gt;% select(gs_name, entrez_gene), -->
					pvalueCutoff = 1
					) <!-- %&gt;%	as_tibble -->
			))</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='va'>df_entrez</span> <span class='op'>=</span> <span class='fu'><a href='symbol_to_entrez.html'>symbol_to_entrez</a></span><span class='op'>(</span><span class='fu'>tidybulk</span><span class='fu'>::</span><span class='va'><a href='counts_mini.html'>counts_mini</a></span>, .transcript <span class='op'>=</span> <span class='va'>transcript</span>, .sample <span class='op'>=</span> <span class='va'>sample</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>'select()' returned 1:many mapping between keys and columns</span></div><div class='input'><span class='va'>df_entrez</span> <span class='op'>=</span> <span class='fu'><a href='aggregate_duplicates.html'>aggregate_duplicates</a></span><span class='op'>(</span><span class='va'>df_entrez</span>, aggregation_function <span class='op'>=</span> <span class='va'>sum</span>, .sample <span class='op'>=</span> <span class='va'>sample</span>, .transcript <span class='op'>=</span> <span class='va'>entrez</span>, .abundance <span class='op'>=</span> <span class='va'>count</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: tidybulk says: for aggregation, factors and logical columns were converted to character</span></div><div class='output co'>#&gt; <span class='message'>Converted to characters</span></div><div class='output co'>#&gt; <span class='message'>logical</span></div><div class='input'><span class='va'>df_entrez</span> <span class='op'>=</span> <span class='fu'><a href='mutate.html'>mutate</a></span><span class='op'>(</span><span class='va'>df_entrez</span>, do_test <span class='op'>=</span> <span class='va'>transcript</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"TNFRSF4"</span>, <span class='st'>"PLCH2"</span>, <span class='st'>"PADI4"</span>, <span class='st'>"PAX7"</span><span class='op'>)</span><span class='op'>)</span>

  <span class='fu'>test_gene_overrepresentation</span><span class='op'>(</span>
    <span class='va'>df_entrez</span>,
    .sample <span class='op'>=</span> <span class='va'>sample</span>,
    .entrez <span class='op'>=</span> <span class='va'>entrez</span>,
    .do_test <span class='op'>=</span> <span class='va'>do_test</span>,
    species<span class='op'>=</span><span class='st'>"Homo sapiens"</span>,
   gene_set<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"C2"</span><span class='op'>)</span>
  <span class='op'>)</span>
</div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span style='color: #555555;'># A tibble: 59 x 10</span><span>
#&gt;    gs_cat ID    Description GeneRatio BgRatio  pvalue p.adjust  qvalue Count
#&gt;    </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>  </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>       </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>     </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>     </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>    </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>   </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;int&gt;</span><span>
#&gt; </span><span style='color: #555555;'> 1</span><span> C2     HOFF… HOFFMAN_CL… 1/4       10/215… 0.001</span><span style='text-decoration: underline;'>85</span><span>   0.039</span><span style='text-decoration: underline;'>8</span><span> 0.009</span><span style='text-decoration: underline;'>95</span><span>     1
#&gt; </span><span style='color: #555555;'> 2</span><span> C2     PEDR… PEDRIOLI_M… 2/4       412/21… 0.002</span><span style='text-decoration: underline;'>13</span><span>   0.039</span><span style='text-decoration: underline;'>8</span><span> 0.009</span><span style='text-decoration: underline;'>95</span><span>     2
#&gt; </span><span style='color: #555555;'> 3</span><span> C2     LIM_… LIM_MAMMAR… 1/4       14/215… 0.002</span><span style='text-decoration: underline;'>59</span><span>   0.039</span><span style='text-decoration: underline;'>8</span><span> 0.009</span><span style='text-decoration: underline;'>95</span><span>     1
#&gt; </span><span style='color: #555555;'> 4</span><span> C2     GAVI… GAVIN_IL2_… 1/4       19/215… 0.003</span><span style='text-decoration: underline;'>52</span><span>   0.039</span><span style='text-decoration: underline;'>8</span><span> 0.009</span><span style='text-decoration: underline;'>95</span><span>     1
#&gt; </span><span style='color: #555555;'> 5</span><span> C2     MYLL… MYLLYKANGA… 1/4       19/215… 0.003</span><span style='text-decoration: underline;'>52</span><span>   0.039</span><span style='text-decoration: underline;'>8</span><span> 0.009</span><span style='text-decoration: underline;'>95</span><span>     1
#&gt; </span><span style='color: #555555;'> 6</span><span> C2     REAC… REACTOME_S… 1/4       26/215… 0.004</span><span style='text-decoration: underline;'>81</span><span>   0.039</span><span style='text-decoration: underline;'>8</span><span> 0.009</span><span style='text-decoration: underline;'>95</span><span>     1
#&gt; </span><span style='color: #555555;'> 7</span><span> C2     REAC… REACTOME_T… 1/4       29/215… 0.005</span><span style='text-decoration: underline;'>36</span><span>   0.039</span><span style='text-decoration: underline;'>8</span><span> 0.009</span><span style='text-decoration: underline;'>95</span><span>     1
#&gt; </span><span style='color: #555555;'> 8</span><span> C2     PEPP… PEPPER_CHR… 1/4       32/215… 0.005</span><span style='text-decoration: underline;'>92</span><span>   0.039</span><span style='text-decoration: underline;'>8</span><span> 0.009</span><span style='text-decoration: underline;'>95</span><span>     1
#&gt; </span><span style='color: #555555;'> 9</span><span> C2     VALK… VALK_AML_C… 1/4       34/215… 0.006</span><span style='text-decoration: underline;'>29</span><span>   0.039</span><span style='text-decoration: underline;'>8</span><span> 0.009</span><span style='text-decoration: underline;'>95</span><span>     1
#&gt; </span><span style='color: #555555;'>10</span><span> C2     JAER… JAERVINEN_… 1/4       40/215… 0.007</span><span style='text-decoration: underline;'>39</span><span>   0.039</span><span style='text-decoration: underline;'>8</span><span> 0.009</span><span style='text-decoration: underline;'>95</span><span>     1
#&gt; </span><span style='color: #555555;'># … with 49 more rows, and 1 more variable: entrez </span><span style='color: #555555;font-style: italic;'>&lt;list&gt;</span><span></div><div class='input'>

</div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Stefano Mangiola.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


